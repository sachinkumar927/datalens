<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content=" Qbitrix DataLens: A modern client-side data explorer for CSV, JSON, Excel, and TXT files. Explore and filter your data easily.">
  <meta name="keywords" content="Qbitrix , Qbitrix DataLens, data explorer, Client Side Data Explorer, data visualization">
  <meta name="author" content="Sachin Kumar">
  <title>DataLens — Client-side Data Explorer</title>

  <!-- Favicon -->
  <link rel="icon" type="image/png" href="assets/DataLensIco.ico" />
  <!-- Optional: shortcut icon for older browsers -->
  <link rel="shortcut icon" href="assets/DataLensIco.ico" type="image/x-icon" />

  <!-- Bootstrap 5 CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Optional: Bootstrap icons (used for UI icons) -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.11.3/font/bootstrap-icons.min.css" rel="stylesheet">

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

  <!-- PapaParse for CSV parsing -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>

  <!-- SheetJS for Excel read/write -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>

  <style>
    :root{
      --bg: #f8f9fa;
      --card: #fff;
      --text: #212529;
      --muted: #6c757d;
    }
    [data-theme="dark"]{
      --bg: #0f1720;
      --card: #0b1220;
      --text: #e6eef8;
      --muted: #9aa7b6;
    }
    body{ background:var(--bg); color:var(--text); transition: background .25s, color .25s;margin-left: 50px;margin-right: 50px; }
    .app-card{ background:var(--card); transition: box-shadow .15s, transform .15s; }
    .toolbar .form-control, .toolbar .btn { min-height: calc(1.5em + .75rem + 2px); }
    /* Sticky header */
    .table-wrapper { max-height: 60vh; overflow: auto; position: relative; }
    table thead th { position: sticky; top: 0; z-index: 5; background: linear-gradient(0deg, rgba(255,255,255,.02), rgba(255,255,255,.02)); backdrop-filter: blur(4px); }
    [data-theme="dark"] table thead th { background: linear-gradient(0deg, rgba(0,0,0,.4), rgba(0,0,0,.4)); }
    /* Table subtle shadow on scroll */
    .table-wrapper.scrolled { box-shadow: 0 8px 25px rgba(0,0,0,0.08); }
    /* Row hover & selection */
    tbody tr:hover { transform: translateY(-2px); transition: transform .12s; }
    tbody tr.selected { background: rgba(13,110,253,0.08); }
    /* Small screen card view */
    @media (max-width: 767px){
      .table-responsive { display:none; }
      .card-view { display:block; }
    }
    @media (min-width: 768px){
      .card-view { display:none; }
    }

    .container{
        max-width: 100%;
    }
    .chart-container{
      height: auto;
    }
    /* Animations */
    .fade-up { transform: translateY(6px); opacity: 0; transition: transform .25s, opacity .25s; }
    .fade-up.in { transform: translateY(0); opacity: 1; }
    .hidden { display:none !important; }
    /* Column visibility menu */
    .cols-menu{ max-height:240px; overflow:auto; }
    /* file drop area */
    .drop-zone { border: 2px dashed rgba(0,0,0,0.12); padding:1.5rem; border-radius:.5rem; text-align:center; transition:background .15s, border-color .15s; }
    .drop-zone.dragover { background: rgba(13,110,253,0.04); border-color: rgba(13,110,253,0.4); }
  </style>
</head>
<body>
  <div class="container py-2">
    <div class="d-flex align-items-center justify-content-between my-2">
      
      <!-- Logo + Title -->
      <h1 class="h4 mb-0 d-flex align-items-center gap-2">
        <img src="assets/DataLensLogo.png" alt="" style="height:40px; width:auto;">
        <div class="d-flex flex-column">
            <span class="fw-bold">
            <span style="color:#022260;">Data</span><span style="color:#0eb0e3;">Lens</span>
            </span>
            <small class="text-muted" style="font-size:12px;">Client - Side Data Explorer</small>
        </div>
      </h1>

      <!-- Right-side controls -->
      <div class="d-flex gap-2 align-items-center">
        <!-- <div class="form-check form-switch me-2">
          <input class="form-check-input" type="checkbox" id="toggleTheme" aria-label="Toggle dark mode">
          <label class="form-check-label" for="toggleTheme">Dark</label>
        </div> -->
        <button class="btn btn-outline-secondary btn-sm" id="btnSample">Load Sample</button>
        <button class="btn btn-outline-danger btn-sm" id="btnClearStorage" title="Clear stored data">Clear Data</button>
      </div>

    </div>
  </div>


    <!-- Main app card -->
    <div class="card app-card p-3">
      <!-- Top controls / Upload -->
      <div class="row g-3 mb-3 toolbar align-items-start">
        <div class="col-lg-5">
          <label class="form-label">File type (choose or Auto-Detect)</label>
          <div class="input-group">
            <select id="fileType" class="form-select" aria-label="File type">
              <option value="auto">Auto-Detect</option>
              <option value="csv">CSV / TXT</option>
              <option value="excel">Excel (.xlsx / .xls)</option>
              <option value="json">JSON</option>
              <option value="xml">XML</option>
              <option value="txt">Plain text</option>
            </select>
            <input id="fileInput" type="file" class="form-control" aria-label="Choose file" />
          </div>

          <div class="mt-2 drop-zone" id="dropZone" tabindex="0" aria-label="Drop file here or click to select">
            <p class="mb-0">Drag & drop file here — or click to browse. Supports CSV, XLSX, JSON, TXT, XML.</p>
            <small class="text-muted">Or choose a sample to test the UI.</small>
          </div>
        </div>

        <div class="col-lg-7">
          <label class="form-label">File & data info</label>
          <div class="d-flex gap-2 align-items-center flex-wrap">
            <div class="border rounded-2 p-2 me-auto" style="min-width:220px;">
              <div><strong id="infoFilename">No file</strong></div>
              <div class="small text-muted" id="infoMIME">—</div>
            </div>

            <div class="border rounded-2 p-2 text-center" style="min-width:120px;">
              <div class="small text-muted">Size</div>
              <div id="infoSize">—</div>
            </div>

            <div class="border rounded-2 p-2 text-center" style="min-width:120px;">
              <div class="small text-muted">Rows</div>
              <div id="infoRows">0</div>
            </div>

            <div class="border rounded-2 p-2 text-center" style="min-width:120px;">
              <div class="small text-muted">Columns</div>
              <div id="infoCols">0</div>
            </div>
          </div>

          <div class="mt-2 d-flex gap-2 align-items-center">
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="persistLocal" />
              <label class="form-check-label" for="persistLocal">Persist in localStorage (across sessions)</label>
            </div>
            <button class="btn btn-outline-primary btn-sm ms-auto" id="btnResetView" title="Reset view">Reset view</button>
            <button class="btn btn-success btn-sm" id="btnExportCSV" title="Export visible rows to CSV"><i class="bi bi-file-earmark-spreadsheet"></i> CSV</button>
            <button class="btn btn-success btn-sm" id="btnExportXLSX" title="Export visible rows to Excel"><i class="bi bi-file-earmark-excel"></i> XLSX</button>
            <button class="btn btn-outline-warning btn-sm" id="btnDownloadOriginal" title="Download original file"><i class="bi bi-download me-1"></i>Download original</button>
          </div>
        </div>
      </div>

      <!-- Controls: search, pagination, columns visibility -->
      <div class="row g-3 align-items-center mb-2">
        <div class="col-md-4">
          <label class="form-label">Global search</label>
          <input id="globalSearch" class="form-control" placeholder="Search across all columns (type to filter)" aria-label="Global search">
        </div>
        <div class="col-md-3">
          <label class="form-label">Rows per page</label>
          <select id="rowsPerPage" class="form-select" aria-label="Rows per page">
            <option>10</option>
            <option>20</option>
            <option>50</option>
            <option>100</option>
          </select>
        </div>
        <div class="col-md-5">
          <label class="form-label">Column visibility & filters</label>
          <div class="d-flex gap-2 align-items-center">
            <div class="dropdown">
              <button class="btn btn-outline-secondary dropdown-toggle" id="colsToggle" data-bs-toggle="dropdown" aria-expanded="false">
                Columns
              </button>
              <div class="dropdown-menu p-3 cols-menu" aria-labelledby="colsToggle" style="min-width:260px;">
                <div id="colsList" class="row g-2"></div>
              </div>
            </div>
            <div class="dropdown">
              <button class="btn btn-outline-secondary dropdown-toggle" id="filtersToggle" data-bs-toggle="dropdown" aria-expanded="false">Column filters</button>
              <div class="dropdown-menu p-3" aria-labelledby="filtersToggle" style="min-width:320px;">
                <div id="colFilters" class="small"></div>
              </div>
            </div>
            <!-- Unique Values -->
            <!-- <div class="dropdown">
              <button class="btn btn-outline-secondary dropdown-toggle" id="uniqueToggle" data-bs-toggle="dropdown" aria-expanded="false">
                Unique values
              </button>
              <div class="dropdown-menu p-3" aria-labelledby="uniqueToggle" style="min-width:320px; max-height:400px; overflow-y:auto;">
                <div id="uniqueValues" class="small"></div>
              </div>
            </div> -->
          </div>
        </div>
      </div>

      <!-- Table / Data area -->
      <div class="row g-3">
        <div class="col-12">
          <div class="table-wrapper border rounded-2 p-0">
            <div class="table-responsive p-2">
              <table id="dataTable" class="table table-hover table-striped align-middle mb-0" role="table" aria-label="Parsed data table">
                <thead id="tableHead"></thead>
                <tbody id="tableBody"></tbody>
              </table>
            </div>
            <div class="card-view p-2"></div>
          </div>

          <!-- Pagination controls -->
          <div class="d-flex align-items-center justify-content-between mt-2">
            <div>
              <small id="pageInfo" class="text-muted">Showing 0 of 0</small>
            </div>
            <nav aria-label="Page navigation">
              <ul class="pagination mb-0" id="pagination"></ul>
            </nav>
          </div>
        </div>

        <!-- Visualization panel -->
        <div class="col-12">
          <hr>
          <div class="d-flex align-items-center gap-2 mb-2">
            <h6 class="mb-0">Quick chart</h6>
            <small class="text-muted">Choose a numeric column and a categorical column</small>
            <div class="ms-auto d-flex gap-2">
              <select id="chartType" class="form-select form-select-sm" style="width:130px;">
                <option value="bar">Bar</option>
                <option value="line">Line</option>
                <option value="pie">Pie</option>
              </select>
              <select id="chartCat" class="form-select form-select-sm" style="width:200px;"></select>
              <select id="chartNum" class="form-select form-select-sm" style="width:200px;"></select>
              <button class="btn btn-primary btn-sm" id="btnDrawChart">Draw</button>
            </div>
          </div>
          <div class="chart-container mt-3"><canvas id="chartCanvas"></canvas></div>
        </div>
      </div>
    </div>

    <!-- Error / Notifications -->
    <div id="notif" class="position-fixed bottom-0 end-0 p-3" style="z-index:1050"></div>
  </div>

  <!-- Bootstrap JS + Popper -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

  <script src="index.js"></script>
  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "SoftwareApplication",
      "name": "DataLens",
      "url": "https://qbitrixdatalens.vercel.app/",
      "description": "Qbitrix DataLens: Client-side data explorer for CSV, JSON, Excel, and TXT files",
      "applicationCategory": "Data visualization",
      "author": {
        "@type": "Person",
        "name": "Sachin Kumar"
      }
    }
  </script>

  <!-- Footer -->
  <footer class="bg-light text-center text-muted py-3 mt-4 border-top">
    <div class="container">
      <p class="mb-1">© 2025 Qbitrix DataLens. All rights reserved.</p>
      <p class="mb-0">  
        Creator & Founder: <a href="https://sachinkumarhebri.vercel.app" target="_blank" class="text-decoration-none">Sachin kumar</a> 
      </p>
    </div>
  </footer>
</body>
</html>
