<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description"
    content="Qbitrix DataLens: A modern client-side data explorer for CSV, JSON, Excel, and TXT files. Explore and filter your data easily.">
  <meta name="keywords" content="Qbitrix, DataLens, data explorer, Client Side Data Explorer, data visualization">
  <meta name="author" content="Sachin Kumar">
  <title>DataLens — Client-side Data Explorer</title>

  <!-- Favicon -->
  <link rel="icon" type="image/png" href="assets/DataLensIco.ico" />
  <link rel="shortcut icon" href="assets/DataLensIco.ico" type="image/x-icon" />
  <link rel="stylesheet" href="styles.css" />
  <!-- Bootstrap 5 CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.11.3/font/bootstrap-icons.min.css"
    rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <!-- PapaParse -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
  <!-- SheetJS -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>

  <style>
    :root {
      --bg: #f8f9fa;
      --card: #fff;
      --text: #212529;
      --muted: #6c757d;
    }

    [data-theme="dark"] {
      --bg: #0f1720;
      --card: #0b1220;
      --text: #e6eef8;
      --muted: #9aa7b6;
    }

    body {
      background: var(--bg);
      color: var(--text);
      transition: background .25s, color .25s;
      padding: 0.5rem;
      margin: 10px;
    }

    .app-card {
      background: var(--card);
      transition: box-shadow .15s, transform .15s;
    }

    .toolbar .form-control,
    .toolbar .btn {
      min-height: calc(1.5em + .75rem + 2px);
    }

    .table-wrapper {
      max-height: 60vh;
      overflow: auto;
      position: relative;
    }

    table thead th {
      position: sticky;
      top: 0;
      z-index: 5;
      background: linear-gradient(0deg, rgba(255, 255, 255, .02), rgba(255, 255, 255, .02));
      backdrop-filter: blur(4px);
    }

    [data-theme="dark"] table thead th {
      background: linear-gradient(0deg, rgba(0, 0, 0, .4), rgba(0, 0, 0, .4));
    }

    tbody tr:hover {
      transform: translateY(-2px);
      transition: transform .12s;
    }

    tbody tr.selected {
      background: rgba(13, 110, 253, 0.08);
    }

    /* Mobile adjustments */
    @media (max-width: 767px) {
      .table-responsive {
        display: none;
      }

      .card-view {
        display: block;
      }

      .toolbar .col-lg-5,
      .toolbar .col-lg-7 {
        flex: 0 0 100%;
        max-width: 100%;
      }

      .d-flex.gap-2.flex-wrap {
        flex-wrap: wrap !important;
      }

      .chart-container {
        overflow-x: auto;
      }

      .dropdown-menu {
        max-width: 100% !important;
      }
    }

    @media (min-width: 768px) {
      .card-view {
        display: none;
      }
    }

    @media(min-width:768px) {
      .header {
        flex-direction: row !important;
      }
    }

    .container {
      max-width: 100%;
    }

    .chart-container {
      height: auto;
    }

    .fade-up {
      transform: translateY(6px);
      opacity: 0;
      transition: transform .25s, opacity .25s;
    }

    .fade-up.in {
      transform: translateY(0);
      opacity: 1;
    }

    .hidden {
      display: none !important;
    }

    .cols-menu {
      max-height: 240px;
      overflow: auto;
    }

    .drop-zone {
      border: 2px dashed rgba(0, 0, 0, 0.12);
      padding: 1.5rem;
      border-radius: .5rem;
      text-align: center;
      transition: background .15s, border-color .15s;
    }

    .drop-zone.dragover {
      background: rgba(13, 110, 253, 0.04);
      border-color: rgba(13, 110, 253, 0.4);
    }
  </style>
</head>

<body>

  <div class="container py-2">

    <!-- Header -->
    <div
      class="header d-flex flex-column flex-md-row align-items-start align-items-md-center justify-content-between mb-3 gap-2">
      <h1 class="h4 d-flex align-items-center gap-2 mb-0">
        <img src="assets/DataLensLogo.png" alt="" style="height:40px; width:auto;">
        <div class="d-flex flex-column">
          <span class="fw-bold"><span style="color:#022260;">Data</span><span style="color:#0eb0e3;">Lens</span></span>
          <small class="text-muted" style="font-size:12px;">Client-Side Data Explorer</small>
        </div>
      </h1>
      <div class="d-flex gap-2 flex-wrap flex-shrink-1">
        <button class="btn btn-warning btn-sm" data-bs-toggle="modal" data-bs-target="#guideModal"><i
            class="bi bi-question-circle"></i> Guide</button>
        <button class="btn btn-outline-secondary btn-sm" id="btnSample" title="Load Sample Dataset">Load Sample</button>
        <button class="btn btn-outline-danger btn-sm" id="btnClearStorage" title="Remove All Data From Storage">Clear
          Data</button>
      </div>
    </div>


    <!-- Main Card -->
    <div class="card app-card p-3">

      <!-- Upload & File Info -->
      <div class="row g-3 mb-3 toolbar">
        <div class="col-lg-5">
          <label class="form-label">File type / Upload</label>
          <div class="input-group">
            <select id="fileType" class="form-select">
              <option value="auto">Auto-Detect</option>
              <option value="csv">CSV / TXT</option>
              <option value="excel">Excel</option>
              <option value="json">JSON</option>
              <option value="xml">XML</option>
              <option value="txt">Plain text</option>
            </select>
            <input id="fileInput" type="file" class="form-control">
          </div>
          <div class="mt-2 drop-zone" id="dropZone" tabindex="0">
            <p class="mb-0">Drag & drop file here — or click to browse</p>
            <small class="text-muted">Supports CSV, XLSX, JSON, TXT, XML</small>
          </div>
        </div>

        <div class="col-lg-7">
          <label class="form-label">File & Data Info</label>
          <div class="d-flex flex-wrap gap-2 mb-2">
            <div class="border rounded-2 p-2 flex-grow-1">
              <div><strong id="infoFilename">No file</strong></div>
              <div class="small text-muted" id="infoMIME">—</div>
            </div>
            <div class="border rounded-2 p-2 text-center" style="min-width:80px;">
              <div class="small text-muted">Size</div>
              <div id="infoSize">—</div>
            </div>
            <div class="border rounded-2 p-2 text-center" style="min-width:80px;">
              <div class="small text-muted">Rows</div>
              <div id="infoRows">0</div>
            </div>
            <div class="border rounded-2 p-2 text-center" style="min-width:80px;">
              <div class="small text-muted">Columns</div>
              <div id="infoCols">0</div>
            </div>
          </div>

          <div class="d-flex flex-wrap gap-2 align-items-center">
            <div class="form-check flex-grow-1">
              <input class="form-check-input" type="checkbox" id="persistLocal">
              <label class="form-check-label" for="persistLocal" title="Push Data To Local Storage">Persist in
                localStorage</label>
            </div>
            <button class="btn btn-outline-primary btn-sm" id="btnResetView" title="Reset All Filter">Reset
              view</button>
            <button class="btn btn-success btn-sm" id="btnExportCSV" title="Export visible rows to CSV"><i
                class="bi bi-file-earmark-spreadsheet"></i> CSV</button>
            <button class="btn btn-success btn-sm" id="btnExportXLSX" title="Export visible rows to Excel"><i
                class="bi bi-file-earmark-excel"></i> XLSX</button>
            <button class="btn btn-outline-warning btn-sm" id="btnDownloadOriginal" title="Download Original"><i
                class="bi bi-download me-1"></i>Download Original</button>
          </div>
        </div>
      </div>

      <!-- Search, Pagination & Column Filters -->
      <div class="row g-3 mb-3 align-items-center">
        <div class="col-md-4">
          <label class="form-label">Global search</label>
          <input id="globalSearch" class="form-control" placeholder="Search across all columns">
        </div>
        <div class="col-md-3">
          <label class="form-label">Rows per page</label>
          <select id="rowsPerPage" class="form-select">
            <option>10</option>
            <option>20</option>
            <option>50</option>
            <option>100</option>
          </select>
        </div>
        <div class="col-md-5 d-flex gap-2 flex-wrap align-items-center">
          <label class="form-label w-100 mb-0">Column visibility & filters</label>
          <div class="dropdown flex-grow-1">
            <button class="btn btn-outline-secondary dropdown-toggle w-100" id="colsToggle"
              data-bs-toggle="dropdown">Columns</button>
            <div class="dropdown-menu p-3 cols-menu" id="colsList"></div>
          </div>
          <div class="dropdown flex-grow-1">
            <button class="btn btn-outline-secondary dropdown-toggle w-100" id="filtersToggle"
              data-bs-toggle="dropdown">Column filters</button>
            <div class="dropdown-menu p-3" id="colFilters"></div>
          </div>
        </div>
      </div>

      <!-- Data Table / Card View -->
      <div class="table-wrapper border rounded-2 p-0 mb-3">
        <div class="table-responsive m-2">
          <table id="dataTable" class="table table-hover table-striped align-middle mb-0">
            <thead id="tableHead"></thead>
            <tbody id="tableBody"></tbody>
          </table>
        </div>
        <div class="card-view p-2"></div>
      </div>

      <!-- Pagination -->
      <div class="d-flex justify-content-between align-items-center mb-3">
        <small id="pageInfo" class="text-muted">Showing 0 of 0</small>
        <nav>
          <ul class="pagination mb-0" id="pagination"></ul>
        </nav>
      </div>

      <!-- Chart Controls -->
      <hr>
      <div class="d-flex flex-column flex-md-row gap-2 align-items-start align-items-md-center mb-2">
        <div>
          <h6 class="mb-0">Quick Chart</h6>
          <small class="text-muted">Choose a numeric & categorical column</small>
        </div>
        <div class="ms-md-auto d-flex flex-wrap gap-2 align-items-center">
          <select id="chartType" class="form-select form-select-sm" style="width:100px;">
            <option value="bar">Bar</option>
            <option value="line">Line</option>
            <option value="pie">Pie</option>
          </select>
          <select id="chartCat" class="form-select form-select-sm" style="width:150px;"></select>
          <select id="chartNum" class="form-select form-select-sm" style="width:150px;"></select>
          <button class="btn btn-primary btn-sm" id="btnDrawChart">Draw</button>
        </div>
      </div>
      <div class="chart-container mt-3"><canvas id="chartCanvas"></canvas></div>

    </div> <!-- /Main Card -->

    <!-- Notifications -->
    <div id="notif" class="position-fixed bottom-0 end-0 p-3" style="z-index:1050"></div>

  </div> <!-- /Container -->

  <!-- Footer -->
  <footer class="bg-light text-center text-muted py-3 mt-4 border-top">
    <div class="container">
      <p class="mb-1">© 2025 Qbitrix DataLens. All rights reserved.</p>
      <p class="mb-0">Creator & Founder: <a href="https://sachinkumarhebri.vercel.app" target="_blank"
          class="text-decoration-none">Sachin Kumar</a></p>
    </div>
  </footer>

  <!-- Guide Modal -->
  <div class="modal fade" id="guideModal" tabindex="-1" aria-labelledby="guideModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable">
      <div class="modal-content rounded-4 shadow-lg animate__animated animate__fadeInUp">
        <div class="modal-header border-0 text-white rounded-top-4" style="background-color: #f8f9fa;">
          <h5 class="modal-title fw-bold" id="guideModalLabel">
            <h1 class="h4 d-flex align-items-center gap-2 mb-0">
              <img src="assets/DataLensLogo.png" alt="" style="height:40px; width:auto;">
              <div class="d-flex flex-column">
                <span class="fw-bold"><span style="color:#022260;">Data</span><span
                    style="color:#0eb0e3;">Lens</span></span>
                <small class="text-muted" style="font-size:12px;">Client-Side Data Explorer</small>
              </div>
            </h1>
          </h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <p class="text-muted">Explore and analyze your data files directly in the browser. No server required.</p>

          <div class="list-group list-group-flush">
            <div class="list-group-item border-0">
              <b>1. File Type / Upload</b><br>
              - Auto-detects format<br>
              - Drag & drop or click to browse<br>
              - Supports <code>CSV, XLSX, JSON, TXT, XML</code>
            </div>

            <div class="list-group-item border-0">
              <b>2. File & Data Info</b><br>
              - File name & size<br>
              - Row & column count<br>
              - Option to persist data in <code>localStorage</code>
            </div>

            <div class="list-group-item border-0">
              <b>3. Global Search</b><br>
              - Search across all columns instantly
            </div>

            <div class="list-group-item border-0">
              <b>4. Rows per Page</b><br>
              - Customize how many rows are shown at once
            </div>

            <div class="list-group-item border-0">
              <b>5. Column Visibility & Filters</b><br>
              - Show/hide columns<br>
              - Apply filters for focused exploration
            </div>

            <div class="list-group-item border-0">
              <b>6. Quick Charts</b><br>
              - Pick one numeric & one categorical column<br>
              - Generate visualizations (e.g., Bar, Line, Pie charts)
            </div>

            <div class="list-group-item border-0">
              <b>7. Export Options</b><br>
              - Export visible rows as <code>CSV</code> or <code>XLSX</code><br>
              - Download original file<br>
              - <b>Export Filtered Data:</b> Download only the filtered dataset in one click
            </div>

            <div class="list-group-item border-0">
              <b>8. Reset & Clear Data</b><br>
              - Reset view → Clears all filters and search<br>
              - Clear Data → Removes dataset from memory & storage
            </div>
          </div>
          <hr>
          <div class="text-center small text-muted">
            <p>© 2025 <b>Qbitrix DataLens</b>. All rights reserved.</p>
            <p>Creator & Founder: <b>Sachin Kumar</b></p>
          </div>
        </div>

        <div class="modal-footer border-0">
          <button type="button" class="btn btn-outline-secondary rounded-pill" data-bs-dismiss="modal">
            Close
          </button>
        </div>
      </div>
    </div>
  </div>


  <!-- Bootstrap JS + Popper -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script type="module" src="./index.js"></script>

</body>

</html>